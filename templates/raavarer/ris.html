{% extends "base.html" %}

{% block title %}Ris ‚Äì Klimaaftryk, Metan & Alternativer | Canteen Buddy{% endblock %}

{% block content %}
<!-- Minimalist Hero -->
<header class="relative h-[70vh] min-h-[500px] flex items-center justify-center overflow-hidden">
  <div class="absolute inset-0 z-0">
    <img src="{{ url_for('static', filename='images/seasonal_salad.jpg') }}" alt="Ris"
      class="w-full h-full object-cover opacity-90">
    <div class="absolute inset-0 bg-black/30"></div>
  </div>

  <div class="relative z-10 text-center text-white px-6">
    <p class="text-sm font-bold tracking-[0.2em] uppercase mb-4 text-white/80">R√•vareleksikon</p>
    <h1 class="font-display text-7xl md:text-9xl font-light tracking-tight mb-6">Ris</h1>
    <p class="font-sans text-xl font-light text-white/90 max-w-xl mx-auto">
      Verdens vigtigste korn. Elsket for sin alsidighed, men udfordret af metan.
    </p>
  </div>
</header>

<!-- The Story: Elaborative Content -->
<section class="py-24 bg-white">
  <div class="mx-auto max-w-7xl px-6 grid grid-cols-1 md:grid-cols-12 gap-12">
    <div class="md:col-span-4">
      <span class="text-9xl font-display font-light text-stone-100 block -mt-8">01</span>
      <h2 class="text-4xl font-display font-light text-stone-900 mb-6 -mt-12 relative z-10">
        Metan-Udfordringen
      </h2>
      <div class="h-1 w-20 bg-cb-orange-medium mb-8"></div>
    </div>
    <div class="md:col-span-8 prose prose-lg text-stone-600 font-light">
      <p class="lead text-xl text-stone-800 font-normal mb-6">
        Ris m√¶tter milliarder, men dyrkningsmetoden har en pris. De oversv√∏mmede rismarker skaber iltfrie forhold, hvor
        bakterier producerer store m√¶ngder metan.
      </p>
      <p class="mb-6">
        Med et klimaaftryk p√• ca. 4.0 kg CO‚ÇÇe pr. kg er ris markant mere belastende end pasta (0.9 kg) og kartofler (0.2
        kg). Det betyder ikke, at vi skal droppe ris, men vi skal bruge det med omtanke.
      </p>
      <p>
        Ved at v√¶lge de rigtige typer, reducere portionerne og supplere med gr√∏ntsager, kan vi nyde risens kvaliteter
        med bedre samvittighed.
      </p>
    </div>
  </div>
</section>

<!-- Environmental Profile (Radar Chart) -->
<section class="py-24 bg-stone-50">
  <div class="mx-auto max-w-7xl px-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
      <div>
        <h3 class="text-3xl font-display font-light text-stone-900 mb-6">Milj√∏profil</h3>
        <p class="text-stone-600 mb-8 font-light">
          Ris har et h√∏jt vandforbrug og betydelige metanemissioner. Arealforbruget er moderat, men intensivt.
        </p>

        <div class="grid grid-cols-2 gap-6 mb-8">
          <div class="p-4 bg-white border border-stone-100 shadow-sm">
            <div class="text-xs font-bold text-stone-400 uppercase tracking-wider mb-1">CO‚ÇÇ Aftryk</div>
            <div class="text-3xl font-display text-stone-900">4.0 <span
                class="text-sm font-sans text-stone-500">kg/kg</span></div>
          </div>
          <div class="p-4 bg-white border border-stone-100 shadow-sm">
            <div class="text-xs font-bold text-stone-400 uppercase tracking-wider mb-1">Vandforbrug</div>
            <div class="text-3xl font-display text-stone-900">2,497 <span
                class="text-sm font-sans text-stone-500">L/kg</span></div>
          </div>
        </div>

        <div class="flex items-center gap-4 text-sm text-stone-500">
          <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-cb-orange-medium"></span> Ris
          </div>
          <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-stone-300"></span> Kartofler (Ref)
          </div>
        </div>
      </div>

      <div class="relative aspect-square max-w-md mx-auto">
        <canvas id="riceRadarChart"></canvas>
      </div>
    </div>
  </div>
</section>

<!-- Rice Types Comparison (Replaces Seasonality) -->
<section class="py-24 bg-stone-900 text-white overflow-hidden">
  <div class="mx-auto max-w-7xl px-6">
    <div class="grid grid-cols-1 md:grid-cols-12 gap-12 items-center">
      <div class="md:col-span-4">
        <h3 class="text-3xl font-display font-light text-white mb-6">Ristyper</h3>
        <p class="text-stone-400 mb-6 font-light">
          Forskellen ligger i forarbejdning og n√¶ring. Klimaaftrykket er h√∏jt for alle typer.
        </p>
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-full bg-cb-orange-dark flex items-center justify-center text-xl">üçö</div>
          <div>
            <div class="text-sm font-bold uppercase tracking-wider text-cb-orange-medium">Strategi</div>
            <div class="text-lg">Mindre m√¶ngder</div>
          </div>
        </div>
      </div>

      <div class="md:col-span-8">
        <div class="space-y-6">
          <!-- Hvid Ris -->
          <div class="flex items-center gap-4 p-4 bg-stone-800/50 rounded-lg border border-stone-700 opacity-70">
            <div class="text-2xl">üçö</div>
            <div class="flex-1">
              <div class="flex justify-between mb-1">
                <span class="font-bold text-stone-300">Hvid Ris</span>
                <span class="text-xs text-stone-500">4.0 kg CO‚ÇÇe</span>
              </div>
              <p class="text-sm text-stone-500">Poleret. Lav n√¶ring, h√∏jt aftryk. Brug sparsomt.</p>
            </div>
          </div>

          <!-- Fuldkornsris -->
          <div class="flex items-center gap-4 p-4 bg-stone-800 rounded-lg border border-stone-700">
            <div class="text-2xl">üå∞</div>
            <div class="flex-1">
              <div class="flex justify-between mb-1">
                <span class="font-bold text-white">Fuldkornsris</span>
                <span class="text-xs text-stone-400">4.2 kg CO‚ÇÇe</span>
              </div>
              <p class="text-sm text-stone-400">Mere fiber og n√¶ring. M√¶tter bedre = mindre forbrug.</p>
            </div>
          </div>

          <!-- Lav-Metan Ris -->
          <div
            class="flex items-center gap-4 p-4 bg-stone-800 rounded-lg border-l-4 border-cb-green-medium shadow-lg shadow-cb-green-medium/10">
            <div class="text-2xl">üå±</div>
            <div class="flex-1">
              <div class="flex justify-between mb-1">
                <span class="font-bold text-cb-green-medium">SRI / T√∏r-Dyrket</span>
                <span class="text-xs text-stone-400">2.5-3.0 kg CO‚ÇÇe</span>
              </div>
              <p class="text-sm text-stone-300">Dyrket med mindre vand. Fremtidens valg.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Culinary Profile -->
<section class="py-24 bg-white">
  <div class="mx-auto max-w-7xl px-6">
    <div class="text-center mb-16">
      <h2 class="font-display text-4xl font-light text-stone-900 mb-4">I K√∏kkenet</h2>
      <p class="text-stone-500 max-w-2xl mx-auto">
        Str√¶k risen med gr√∏ntsager eller brug alternativer for variation.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div class="group cursor-pointer">
        <div class="aspect-[4/3] overflow-hidden mb-6 bg-stone-100">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-stone-400">Blomk√•lsris</div>
        </div>
        <h3 class="text-xl font-display text-stone-900 mb-2">Blomk√•lsris</h3>
        <p class="text-sm text-stone-600 font-light">
          Revet blomk√•l blandet 50/50 med ris. Halverer kalorier og klimaaftryk, √∏ger gr√∏ntindtag.
        </p>
      </div>

      <div class="group cursor-pointer">
        <div class="aspect-[4/3] overflow-hidden mb-6 bg-stone-100">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-stone-400">Bygotto</div>
        </div>
        <h3 class="text-xl font-display text-stone-900 mb-2">Nordiske Ris (Perlebyg/Rug)</h3>
        <p class="text-sm text-stone-600 font-light">
          Perlebyg eller perlerug har bid som ris, men dyrkes lokalt med minimalt aftryk.
        </p>
      </div>

      <div class="group cursor-pointer">
        <div class="aspect-[4/3] overflow-hidden mb-6 bg-stone-100">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-stone-400">Stegte Ris</div>
        </div>
        <h3 class="text-xl font-display text-stone-900 mb-2">Stegte Ris (Reste-Guld)</h3>
        <p class="text-sm text-stone-600 font-light">
          Perfekt til at bruge daggammel ris. Tils√¶t masser af fintsnittede gr√∏ntsager og √¶g/tofu.
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Calculator Section (Adapted) -->
<section class="py-24 bg-cb-taupe-light">
  <div class="mx-auto max-w-4xl px-6">
    <div class="text-center mb-12">
      <h2 class="font-display text-4xl font-light text-stone-900 mb-4">Beregn Din Besparelse</h2>
      <p class="text-stone-600">Se effekten af at reducere risforbruget</p>
    </div>

    <div class="bg-white p-8 shadow-sm border border-stone-100">
      <div class="mb-6">
        <label class="block font-sans text-xs font-bold uppercase tracking-wider text-stone-500 mb-2">
          Kg ris pr. m√•ned
        </label>
        <div class="flex items-center gap-4">
          <input type="range" id="riceAmount" min="20" max="500" value="150" step="10"
            class="flex-1 h-1 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-cb-orange-medium"
            oninput="calculateRiceSavings()">
          <span id="riceAmountDisplay" class="font-display text-2xl text-cb-orange-medium min-w-[80px]">150</span>
        </div>
      </div>

      <div class="mb-8">
        <label class="block font-sans text-xs font-bold uppercase tracking-wider text-stone-500 mb-2">
          Strategi
        </label>
        <select id="riceStrategy"
          class="w-full p-3 bg-stone-50 border-none font-sans text-stone-700 focus:ring-1 focus:ring-cb-orange-medium"
          onchange="calculateRiceSavings()">
          <option value="portion25">25% mindre portioner (mere gr√∏nt)</option>
          <option value="potato50">Erstat 50% med kartofler</option>
          <option value="pasta50">Erstat 50% med pasta</option>
          <option value="barley">Erstat 50% med perlebyg (lokalt)</option>
        </select>
      </div>

      <div id="riceSavingsResult" class="border-t border-stone-100 pt-8">
        <div class="grid grid-cols-2 gap-8 text-center">
          <div>
            <div class="text-xs font-bold uppercase tracking-wider text-stone-400 mb-1">M√•nedlig besparelse</div>
            <div class="text-3xl font-display text-stone-900">
              <span id="savedRiceEmissions">0</span> <span class="text-sm text-stone-500">kg CO‚ÇÇe</span>
            </div>
          </div>
          <div>
            <div class="text-xs font-bold uppercase tracking-wider text-stone-400 mb-1">√Örlig besparelse</div>
            <div class="text-3xl font-display text-stone-900">
              <span id="yearlyRiceImpact">0</span> <span class="text-sm text-stone-500">kg CO‚ÇÇe</span>
            </div>
          </div>
        </div>
        <p id="championRiceMessage" class="text-center text-sm text-cb-green-dark mt-6 font-medium"></p>
      </div>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Radar Chart
  const ctx = document.getElementById('riceRadarChart').getContext('2d');
  new Chart(ctx, {
    type: 'radar',
    data: {
      labels: ['CO‚ÇÇ Aftryk', 'Vandforbrug', 'Arealforbrug', 'Eutrofiering', 'Biodiversitet'],
      datasets: [{
        label: 'Ris',
        data: [45, 90, 40, 60, 50], // High water, moderate CO2
        backgroundColor: 'rgba(249, 115, 22, 0.2)',
        borderColor: 'rgba(249, 115, 22, 1)',
        pointBackgroundColor: 'rgba(249, 115, 22, 1)',
        borderWidth: 2
      }, {
        label: 'Kartofler (Ref)',
        data: [5, 10, 10, 20, 10], // Very low impact
        backgroundColor: 'rgba(168, 162, 158, 0.2)',
        borderColor: 'rgba(168, 162, 158, 1)',
        pointBackgroundColor: 'rgba(168, 162, 158, 1)',
        borderWidth: 1,
        borderDash: [5, 5]
      }]
    },
    options: {
      scales: {
        r: {
          beginAtZero: true,
          max: 100,
          ticks: { display: false },
          grid: { color: 'rgba(0,0,0,0.05)' }
        }
      },
      plugins: {
        legend: { display: false }
      }
    }
  });

  // Calculator Logic
  const riceAmountSlider = document.getElementById('riceAmount');
  const riceAmountDisplay = document.getElementById('riceAmountDisplay');
  const riceStrategySelect = document.getElementById('riceStrategy');
  const savedRiceEmissionsDisplay = document.getElementById('savedRiceEmissions');
  const yearlyRiceImpactDisplay = document.getElementById('yearlyRiceImpact');
  const championRiceMessageDisplay = document.getElementById('championRiceMessage');

  const RICE_CO2 = 4.0;
  const POTATO_CO2 = 0.2;
  const PASTA_CO2 = 0.9;
  const BARLEY_CO2 = 0.6; // Approx for pearl barley

  function calculateRiceSavings() {
    const amount = parseInt(riceAmountSlider.value);
    const strategy = riceStrategySelect.value;

    riceAmountDisplay.textContent = amount;

    let savedEmissions = 0;

    if (strategy === 'portion25') {
      savedEmissions = (amount * 0.25) * RICE_CO2;
    } else if (strategy === 'potato50') {
      savedEmissions = (amount * 0.50) * (RICE_CO2 - POTATO_CO2);
    } else if (strategy === 'pasta50') {
      savedEmissions = (amount * 0.50) * (RICE_CO2 - PASTA_CO2);
    } else if (strategy === 'barley') {
      savedEmissions = (amount * 0.50) * (RICE_CO2 - BARLEY_CO2);
    }

    const yearlySavings = savedEmissions * 12;

    savedRiceEmissionsDisplay.textContent = Math.round(savedEmissions).toLocaleString();
    yearlyRiceImpactDisplay.textContent = Math.round(yearlySavings).toLocaleString();

    if (savedEmissions > 0) {
      championRiceMessageDisplay.textContent = `Du reducerer klimaaftrykket med ${Math.round(savedEmissions)} kg CO‚ÇÇe hver m√•ned!`;
      championRiceMessageDisplay.className = "text-center text-sm text-cb-green-dark mt-6 font-medium";
    } else {
      championRiceMessageDisplay.textContent = "Ingen besparelse.";
      championRiceMessageDisplay.className = "text-center text-sm text-stone-500 mt-6 font-medium";
    }
  }

  // Init
  calculateRiceSavings();
</script>
{% endblock %}