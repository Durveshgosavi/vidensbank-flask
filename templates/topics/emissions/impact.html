{% extends "base.html" %}

{% block title %}Beregn Aftryk - Vidensbank{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/infographics.css') }}?v=1.0">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="relative h-[50vh] min-h-[400px] w-full overflow-hidden">
  <div class="absolute inset-0">
    <img src="{{ url_for('static', filename='images/emissions_hero.jpg') }}" alt="Sustainable Canteen"
      class="h-full w-full object-cover">
    <div class="absolute inset-0 brand-overlay"></div>
  </div>

  <div class="relative z-10 flex h-full flex-col justify-center px-6 md:px-24 text-white">
    <h1
      class="mb-6 max-w-4xl font-display text-6xl font-bold leading-none tracking-brand-wide md:text-8xl uppercase text-cb-green-light">
      Beregn<br>Aftryk
    </h1>
    <p class="max-w-2xl font-sans text-lg font-normal leading-relaxed text-white">
      Brug dette værktøj til at estimere CO₂-belastningen baseret på generelle standardtal fra Concito. Resultatet er
      vejledende.
    </p>
  </div>
</div>

<!-- Calculator Section -->
<section class="bg-cb-taupe-light py-24">
  <div class="mx-auto max-w-5xl px-6">
    <div class="overflow-hidden rounded-none bg-white shadow-2xl">
      <div class="grid grid-cols-1 md:grid-cols-2">
        <!-- Form -->
        <div class="p-8 md:p-16">
          <h2 class="mb-8 font-display text-3xl font-bold text-stone-900 uppercase tracking-brand-wide">Indtast Data
          </h2>
          <form id="impactForm" class="space-y-8">
            <div>
              <label class="mb-2 block font-sans text-xs font-bold uppercase tracking-widest text-stone-500">Antal
                Gæster (pr. dag)</label>
              <input type="number" id="guests" value="200"
                class="w-full border-b border-stone-300 bg-transparent py-2 font-display text-3xl font-bold text-stone-900 focus:border-cb-green-dark focus:outline-none transition-colors">
            </div>

            <div>
              <label class="mb-2 block font-sans text-xs font-bold uppercase tracking-widest text-stone-500">Oksekød
                (kg/uge)</label>
              <input type="number" id="beef" value="20"
                class="w-full border-b border-stone-300 bg-transparent py-2 font-display text-3xl font-bold text-stone-900 focus:border-cb-green-dark focus:outline-none transition-colors">
              <p class="mt-1 text-xs text-stone-400">Concito gns: 28 kg CO₂e/kg</p>
            </div>

            <div>
              <label class="mb-2 block font-sans text-xs font-bold uppercase tracking-widest text-stone-500">Grøntsager
                (kg/uge)</label>
              <input type="number" id="veg" value="150"
                class="w-full border-b border-stone-300 bg-transparent py-2 font-display text-3xl font-bold text-stone-900 focus:border-cb-green-dark focus:outline-none transition-colors">
              <p class="mt-1 text-xs text-stone-400">Concito gns: 0.4 kg CO₂e/kg</p>
            </div>
          </form>
        </div>

        <!-- Result -->
        <div class="flex flex-col justify-center bg-cb-green-dark p-8 text-white md:p-16">
          <span class="mb-2 block font-sans text-xs font-bold uppercase tracking-widest text-cb-green-light">Estimeret
            Aftryk</span>
          <div class="mb-2 font-display text-7xl font-bold" id="resultValue">0</div>
          <div class="mb-12 font-sans text-xl text-cb-green-light">kg CO₂e / uge</div>

          <div class="space-y-6 border-t border-cb-green-medium/30 pt-8">
            <div class="flex justify-between font-sans text-sm">
              <span class="text-cb-green-light">Pr. gæst pr. måltid</span>
              <span class="font-bold text-white" id="perGuestValue">0 kg</span>
            </div>
            <div class="flex justify-between font-sans text-sm">
              <span class="text-cb-green-light">Tilsvarende bilkørsel</span>
              <span class="font-bold text-white" id="carKmValue">0 km</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Context Section -->
<section class="bg-white py-24">
  <div class="mx-auto max-w-3xl px-6 text-center">
    <h2 class="mb-8 font-display text-4xl font-bold text-stone-900 uppercase tracking-brand-wide">Referenceværdier</h2>
    <p class="mb-12 font-sans text-lg leading-relaxed text-stone-600">
      Et gennemsnitligt dansk måltid udleder ca. 1,8 kg CO₂e. En klimavenlig ret bør ifølge eksperter ligge under 0,5 kg
      CO₂e.
    </p>

    <div class="comparison-chart text-left mb-12">
      <div class="chart-title">Aftryk pr. kg Råvare</div>

      <div class="chart-item">
        <div class="chart-label">
          <span>Oksekød</span>
          <span><strong>~28 kg CO₂e</strong></span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar emissions-very-high" style="width: 100%;">Højest</div>
        </div>
      </div>

      <div class="chart-item">
        <div class="chart-label">
          <span>Svinekød</span>
          <span><strong>~4.6 kg CO₂e</strong></span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar emissions-medium" style="width: 16%;">Middel</div>
        </div>
      </div>

      <div class="chart-item">
        <div class="chart-label">
          <span>Kylling</span>
          <span><strong>~3.5 kg CO₂e</strong></span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar emissions-medium" style="width: 12%;">Middel</div>
        </div>
      </div>

      <div class="chart-item">
        <div class="chart-label">
          <span>Linser/Bønner</span>
          <span><strong>~0.8 kg CO₂e</strong></span>
        </div>
        <div class="chart-bar-container">
          <div class="chart-bar emissions-very-low" style="width: 3%;">Lavest</div>
        </div>
      </div>
    </div>

    <div class="citation-box text-left">
      <span class="citation-label">Kilde</span>
      <p class="citation-text">
        CONCITO. (2025). Den store klimadatabase, version 1.2.
        <a href="https://denstoreklimadatabase.dk/" target="_blank">Besøg databasen</a>
      </p>
    </div>
    <a href="{{ url_for('topic_emissions_tips') }}"
      class="inline-block border-b-2 border-cb-green-dark pb-1 text-sm font-bold uppercase tracking-widest text-cb-green-dark transition-colors hover:text-cb-green-medium">
      Se Best Practice →
    </a>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const inputs = ['guests', 'beef', 'veg'];

    function calculate() {
      const guests = parseFloat(document.getElementById('guests').value) || 0;
      const beef = parseFloat(document.getElementById('beef').value) || 0;
      const veg = parseFloat(document.getElementById('veg').value) || 0;

      // Factors based on Concito averages (approx)
      const beefFactor = 28; // High impact
      const vegFactor = 0.4; // Low impact

      const total = (beef * beefFactor) + (veg * vegFactor);
      const perGuest = guests > 0 ? (total / (guests * 5)) : 0; // Assuming 5 days a week
      const carKm = total / 0.12; // Approx 120g/km for a new car

      document.getElementById('resultValue').textContent = Math.round(total).toLocaleString('da-DK');
      document.getElementById('perGuestValue').textContent = perGuest.toFixed(2).replace('.', ',') + ' kg';
      document.getElementById('carKmValue').textContent = Math.round(carKm).toLocaleString('da-DK') + ' km';
    }

    inputs.forEach(id => {
      document.getElementById(id).addEventListener('input', calculate);
    });

    calculate();
  });
</script>
{% endblock %}